<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Padel Scheduler — Multi Court (≥5 players)</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  :root { --card: #ffffff; --muted: #64748b; }
  body {
  background: url("assets/background.png") no-repeat center center fixed;
  background-size: cover;
  font-family: 'Inter', 'Segoe UI', sans-serif;
  color: #e5e7eb;
}
.card { background: rgba(15, 23, 42, 0.75); backdrop-filter: blur(14px); border-radius: 1rem; border: 1px solid rgba(255, 255, 255, 0.08); box-shadow: 0 8px 24px rgba(0,0,0,0.6); color: #f1f5f9; font-weight: 500; }
.btn { background: rgba(30, 41, 59, 0.85); border: 1px solid rgba(255,255,255,0.15); color: #f8fafc; border-radius: 0.5rem; padding: 0.45rem 1rem; font-weight: 500; transition: all 0.2s ease-in-out; }
.btn:hover { background: rgba(51, 65, 85, 0.95); transform: translateY(-2px); }
.table { width: 100%; border-collapse: collapse; font-size: 0.95rem; color: #f9fafb; }
.table th { background: linear-gradient(135deg, #1e293b, #0f172a); color: #f9fafb; font-weight: 600; text-align: left; padding: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
.table td { padding: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.05); }
.table tbody tr:hover { background: rgba(255,255,255,0.06); }
.input, textarea, select { background: rgba(30, 41, 59, 0.85); border: 1px solid rgba(255, 255, 255, 0.15); border-radius: 0.4rem; padding: 0.4rem 0.6rem; color: #f1f5f9; font-size: 0.9rem; width: 100%; outline: none; transition: all 0.2s ease-in-out; }
.input:focus, textarea:focus, select:focus { border-color: #3b82f6; background: rgba(51, 65, 85, 0.95); }
.scoreInput { width: 4rem; text-align: center; }
input:disabled, select:disabled, textarea:disabled { background: rgba(30, 41, 59, 0.6); color: #94a3b8; cursor: not-allowed; }
</style>
</head>
<body>
<div class="max-w-6xl mx-auto p-4 space-y-6">

  <header class="flex items-center justify-between">
    <div>
      <h1 id="title" class="text-2xl font-bold">Padel Scheduler</h1>
      <p id="subtitle" class="text-sm text-slate-500">Supports ≥5 players · choose 1 or 2 courts · per-round balanced doubles</p>
    </div>
    <div class="flex gap-2">
      <select id="langSwitcher" class="input w-28">
        <option value="en">English</option>
        <option value="zh">中文</option>
      </select>
      <button id="btnExportCSV" class="btn" data-i18n="export">Export Overall CSV</button>
      <button id="btnReset" class="btn" data-i18n="reset">Reset</button>
    </div>
  </header>

  <!-- Settings -->
  <section class="card p-4">
    <div class="grid md:grid-cols-4 gap-4">
      <div class="md:col-span-2">
        <label class="block text-sm font-medium mb-1" data-i18n="players">Players (comma-separated)</label>
        <textarea id="playersInput" rows="3" class="input" placeholder="Alice, Bob, Carol, Dave, Eve, ..."></textarea>
        <p id="playersNote" class="text-xs text-slate-500 mt-1">Minimum 5 players. Odd counts are allowed (scheduler handles).</p>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1" data-i18n="matches">Matches per player (per round)</label>
        <input id="matchesPerPlayer" type="number" min="1" max="8" value="4" class="input">
      </div>

      <div>
        <label class="block text-sm font-medium mb-1" data-i18n="courtMode">Court Mode</label>
        <select id="courtMode" class="input">
          <option value="1">1 Court (All players in Court A)</option>
          <option value="2" selected>2 Courts (Split A & B)</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1" data-i18n="strategy">Next-round strategy</label>
        <select id="strategy" class="input">
          <option value="winnersTogether">Winners → Court A, Losers → Court B</option>
          <option value="winnersDistributed">Distribute winners evenly</option>
        </select>
      </div>

      <div class="md:col-span-4">
        <button id="btnGenerateR1" class="btn btn-primary mt-2" data-i18n="genRound1">Generate Round 1</button>
      </div>
    </div>
  </section>

  <!-- Rounds -->
  <section class="grid md:grid-cols-2 gap-6">
    <div class="card p-4">
      <div class="flex items-center justify-between mb-3">
        <h2 class="font-semibold" id="titleRoundA">Round 1 — Court A</h2>
        <button id="btnBuildNextRound" class="btn btn-primary" data-i18n="nextRound">Build Next Round</button>
      </div>
      <div class="overflow-x-auto">
        <table class="table" id="tblA">
          <thead><tr><th>#</th><th data-i18n="team1">Team 1</th><th data-i18n="team2">Team 2</th><th data-i18n="t1games">T1 Games</th><th data-i18n="t2games">T2 Games</th><th data-i18n="winner">Winner</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="card p-4" id="courtBCard">
      <h2 class="font-semibold mb-3" id="titleRoundB">Round 1 — Court B</h2>
      <div class="overflow-x-auto">
        <table class="table" id="tblB">
          <thead><tr><th>#</th><th data-i18n="team1">Team 1</th><th data-i18n="team2">Team 2</th><th data-i18n="t1games">T1 Games</th><th data-i18n="t2games">T2 Games</th><th data-i18n="winner">Winner</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- Leaderboards -->
  <section class="card p-4">
    <div class="flex items-center justify-between mb-3">
      <h2 class="font-semibold" data-i18n="leaderboard">Leaderboards</h2>
      <div class="flex gap-2">
        <button id="btnSubmit" class="btn" data-i18n="submit">Submit Scores</button>
        <button id="btnResubmit" class="btn" data-i18n="resubmit">Resubmit</button>
        <button id="btnRecalcLB" class="btn" data-i18n="recalc">Recalculate</button>
      </div>
    </div>
    <div id="lbPanels" class="space-y-6"></div>
  </section>

</div>

<script>
/* 多语言文本 */
const translations = {
  en: {
    title: "Padel Scheduler",
    subtitle: "Supports ≥5 players · choose 1 or 2 courts · per-round balanced doubles",
    players: "Players (comma-separated)",
    playersNote: "Minimum 5 players. Odd counts are allowed (scheduler handles).",
    matches: "Matches per player (per round)",
    courtMode: "Court Mode",
    strategy: "Next-round strategy",
    genRound1: "Generate Round 1",
    roundLabel: (n, court) => `Round ${n} — Court ${court}`,
    nextRound: "Build Next Round",
    team1: "Team 1",
    team2: "Team 2",
    t1games: "T1 Games",
    t2games: "T2 Games",
    winner: "Winner",
    leaderboard: "Leaderboards",
    submit: "Submit Scores",
    resubmit: "Resubmit",
    recalc: "Recalculate",
    export: "Export Overall CSV",
    reset: "Reset"
  },
  zh: {
    title: "Padel 排程器",
    subtitle: "支持 ≥5 名球员 · 可选 1 或 2 个场地 · 每轮平衡双打",
    players: "球员名单（逗号分隔）",
    playersNote: "至少输入 5 名球员。允许奇数人数（系统会自动处理）",
    matches: "每名球员每轮比赛场数",
    courtMode: "场地模式",
    strategy: "下一轮分配策略",
    genRound1: "生成第 1 轮",
    roundLabel: (n, court) => `第 ${n} 轮 — 场地 ${court}`,
    nextRound: "生成下一轮",
    team1: "队伍 1",
    team2: "队伍 2",
    t1games: "队伍 1 得分",
    t2games: "队伍 2 得分",
    winner: "胜者",
    leaderboard: "排行榜",
    submit: "提交成绩",
    resubmit: "重新提交",
    recalc: "重新计算",
    export: "导出总排行榜 CSV",
    reset: "重置"
  }
};

function applyTranslations(lang) {
  const t = translations[lang];
  document.getElementById("title").textContent = t.title;
  document.getElementById("subtitle").textContent = t.subtitle;
  document.querySelector("[data-i18n='players']").textContent = t.players;
  document.getElementById("playersNote").textContent = t.playersNote;
  document.querySelector("[data-i18n='matches']").textContent = t.matches;
  document.querySelector("[data-i18n='courtMode']").textContent = t.courtMode;
  document.querySelector("[data-i18n='strategy']").textContent = t.strategy;
  document.querySelector("[data-i18n='genRound1']").textContent = t.genRound1;
  document.querySelector("[data-i18n='nextRound']").textContent = t.nextRound;
  document.querySelectorAll("[data-i18n='team1']").forEach(el=>el.textContent = t.team1);
  document.querySelectorAll("[data-i18n='team2']").forEach(el=>el.textContent = t.team2);
  document.querySelectorAll("[data-i18n='t1games']").forEach(el=>el.textContent = t.t1games);
  document.querySelectorAll("[data-i18n='t2games']").forEach(el=>el.textContent = t.t2games);
  document.querySelectorAll("[data-i18n='winner']").forEach(el=>el.textContent = t.winner);
  document.querySelector("[data-i18n='leaderboard']").textContent = t.leaderboard;
  document.querySelector("[data-i18n='submit']").textContent = t.submit;
  document.querySelector("[data-i18n='resubmit']").textContent = t.resubmit;
  document.querySelector("[data-i18n='recalc']").textContent = t.recalc;
  document.querySelector("[data-i18n='export']").textContent = t.export;
  document.querySelector("[data-i18n='reset']").textContent = t.reset;

  // 更新轮次标题
  document.getElementById("titleRoundA").textContent = t.roundLabel(1, "A");
  document.getElementById("titleRoundB").textContent = t.roundLabel(1, "B");
}

// 切换事件
const langSwitcher = document.getElementById("langSwitcher");
langSwitcher.addEventListener("change", e => {
  const lang = e.target.value;
  applyTranslations(lang);
  localStorage.setItem("padelLang", lang);
});

// 初始化语言
window.addEventListener("DOMContentLoaded", () => {
  const saved = localStorage.getItem("padelLang") || "en";
  langSwitcher.value = saved;
  applyTranslations(saved);
});
</script>
</body>
</html>
